generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Event {
  id             String   @id @default(cuid())
  title          String
  descriptionShort String?
  curatorNote    String?  // Recommendations
  startAt        DateTime
  endAt          DateTime?
  durationMin    Int?
  venueName      String
  area           String?  // e.g. "Tenmonkan"
  address        String?
  lat            Float?
  lng            Float?
  priceText      String?  // "Free", "2000 yen"
  isFree         Boolean  @default(false)
  
  // Attributes for filtering/weighting
  indoor         Boolean  @default(false)
  kidsOk         Boolean  @default(false)
  strollerOk     Boolean  @default(false)
  nursingRoom    Boolean  @default(false)
  diaperChanging Boolean  @default(false)
  parking        Boolean  @default(false)
  
  // Additional mode-specific flags
  after18        Boolean  @default(false) // For Workers
  nearStation    Boolean  @default(false) // For Workers/Tourists
  foodDrink      Boolean  @default(false) // For Workers
  weekdayNight   Boolean  @default(false) // For Workers
  
  social         Boolean  @default(false) // For Students
  photogenic     Boolean  @default(false) // For Students
  discount       Boolean  @default(false) // For Students
  
  englishSupport Boolean  @default(false) // For Tourists

  tags           String?  // Comma separated tags if needed for extra info
  
  bookingUrl     String?
  sourceUrl      String?
  imageUrl       String?
  
  status         String   @default("DRAFT") // PUBLISHED, DRAFT, ENDED, CANCELED
  wildcard       Boolean  @default(false)
  
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  
  logs           SwipeLog[]
}

model SwipeLog {
  id        String   @id @default(cuid())
  eventId   String
  action    String   // LIKE, NOPE, SAVE, CLICK
  anonId    String?
  createdAt DateTime @default(now())
  
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
}
